#----------------------------------------------------------------------------
# Destination directory for binaries and class libraries
#----------------------------------------------------------------------------
PREFIX  = ../../..
OBJ_DIR = .obj/
LIB_DIR	= $(PREFIX)/lib

OUT		= posix_msg posix_msg_sigev \
			posix_shm \
			posix_nameless_sem posix_named_sem_cnt

#----------------------------------------------------------------------------
# Compiler and linker options.
#----------------------------------------------------------------------------
CC			= gcc
CFLAGS 		= -Wall -g 
CPPFLAGS	= -I$(PREFIX)/include

CPICFLAGS	= -fPIC 
LDSOFLAGS	= -G -dy
ARFLAGS		= ruv

LOADLIBES	= -L$(PREFIX)/lib
LDLIBS		= -lrt -lpthread
#----------------------------------------------------------------------------
# user defined macros
#----------------------------------------------------------------------------
SRCS        = $(wildcard *.c)
OBJS        = $(patsubst %.c,%.o,$(SRCS))
DEPENDENCY  = dep.mk

#----------------------------------------------------------------------------
# Default target.
#----------------------------------------------------------------------------

all: $(OUT)

#----------------------------------------------------------------------------
# Suffix rules
#----------------------------------------------------------------------------

# remove all built-in suffix rule
.SUFFIXES:
.PRECIOUS: .o

%: %.o
	$(CC) $< $(LOADLIBES) $(LDLIBS) -o $@

%.o: %.c
	$(CC) -c $(CFLAGS) $(CPPFLAGS) $< -o $@


#----------------------------------------------------------------------------
# Static pattern rule
#----------------------------------------------------------------------------


#----------------------------------------------------------------------------
# Build library
#----------------------------------------------------------------------------

#----------------------------------------------------------------------------
# Build sample program
#----------------------------------------------------------------------------


#----------------------------------------------------------------------------
# others
#----------------------------------------------------------------------------

clean:
	rm -f *.o core core.* output*.txt $(DEPENDENCY) $(OUT)

-include $(DEPENDENCY)
